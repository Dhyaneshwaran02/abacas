(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{8091:(e,t,s)=>{Promise.resolve().then(s.bind(s,2410))},2410:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5155),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2115),next_navigation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6046),firebase_firestore__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7058),_firebaseConfig__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1568);let SequencePage=()=>{let router=(0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter)(),searchParams=(0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.useSearchParams)(),assignmentId=searchParams.get("id"),[sequence,setSequence]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[currentQuestionIndex,setCurrentQuestionIndex]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[isPaused,setIsPaused]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[timeInterval,setTimeInterval]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[currentSequenceIndex,setCurrentSequenceIndex]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[currentSequence,setCurrentSequence]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0),[showAnswer,setShowAnswer]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[calculatedAnswer,setCalculatedAnswer]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{(async()=>{if(assignmentId)try{let t=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_3__.H9)(_firebaseConfig__WEBPACK_IMPORTED_MODULE_4__.db,"Assignment",assignmentId),s=await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_3__.x7)(t);if(s.exists()){var e;let t=s.data(),n=t.sequence||[],a=t.timeInterval||0;setSequence(n),setTimeInterval(a),prepareCurrentSequence((null===(e=n[0])||void 0===e?void 0:e.question)||"")}else console.error("No document found with the given assignmentId."),alert("Assignment not found. Redirecting to home."),router.push("/")}catch(e){console.error("Error fetching assignment data:",e),alert("Failed to fetch assignment. Redirecting to home."),router.push("/")}finally{setLoading(!1)}})()},[assignmentId,router]);let prepareCurrentSequence=e=>{let t=[],s=/([+\-*/รท]?\d+(\.\d+)?)/g,n=e.match(s);n&&t.push(...n),setCurrentSequence(t),setCurrentSequenceIndex(0),setShowAnswer(!1),setCalculatedAnswer(null)};(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{if(!isPaused&&currentSequenceIndex<currentSequence.length){new Audio("/beep.mp3").play();let e=setTimeout(()=>{setCurrentSequenceIndex(e=>e+1)},1e3*timeInterval);return()=>clearTimeout(e)}},[currentSequenceIndex,currentSequence,isPaused,timeInterval]);let handleNextQuestion=()=>{currentQuestionIndex+1<sequence.length&&(setCurrentQuestionIndex(e=>e+1),prepareCurrentSequence(sequence[currentQuestionIndex+1].question),setIsPaused(!1))},handlePreviousQuestion=()=>{currentQuestionIndex-1>=0&&(setCurrentQuestionIndex(e=>e-1),prepareCurrentSequence(sequence[currentQuestionIndex-1].question),setIsPaused(!1))},calculateAnswer=question=>{try{let sanitizedExpression=question.replace(/รท/g,"/").replace(/[^\d+\-*/().]/g,""),answer=eval(sanitizedExpression);isNaN(answer)?setCalculatedAnswer("Invalid Expression"):setCalculatedAnswer(answer.toString())}catch(error){console.error(error),setCalculatedAnswer("Invalid Expression")}},handleShowAnswer=()=>{currentSequence.length>0&&calculateAnswer(currentSequence.join("")),setShowAnswer(!0)},formatQuestionForDisplay=e=>e.replace(/\*/g,"x").replace(/\//g,"\xf7");return loading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:"Loading..."})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 min-h-screen flex flex-col items-center py-10",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"bg-orange-500 shadow-md rounded-lg p-8 w-[800px]",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-8xl font-semibold text-center",children:String.fromCharCode(65+currentQuestionIndex)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"text-9xl font-bold text-center my-8",children:currentSequenceIndex<currentSequence.length?formatQuestionForDisplay(currentSequence[currentSequenceIndex]):"Completed!"}),currentSequenceIndex>=currentSequence.length&&!showAnswer&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:handleShowAnswer,className:"bg-green-500 text-white px-4 py-2 rounded-md mx-auto block",children:"Show Answer"}),showAnswer&&calculatedAnswer&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"text-6xl text-center mt-4",children:["Answer: ",calculatedAnswer||"N/A"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex justify-between mt-10",children:[currentSequenceIndex>=currentSequence.length&&currentQuestionIndex>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:handlePreviousQuestion,className:"bg-gray-500 text-white px-4 py-2 rounded-md",children:"Previous"}),currentSequenceIndex>=currentSequence.length&&currentQuestionIndex<sequence.length-1&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:handleNextQuestion,className:"bg-blue-500 text-white px-4 py-2 rounded-md",children:"Next"}),currentSequenceIndex>=currentSequence.length&&currentQuestionIndex===sequence.length-1&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>router.push("/"),className:"bg-blue-500 text-white px-4 py-2 rounded-md",children:"Home"})]}),currentSequenceIndex<currentSequence.length&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:()=>setIsPaused(!isPaused),className:"mt-5 px-4 py-2 rounded-md ".concat(isPaused?"bg-blue-500":"bg-red-500"," text-white mx-auto block"),children:isPaused?"Continue":"Pause"}),currentSequenceIndex<currentSequence.length&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-center text-lg mt-2",children:"Sequence in progress..."})]})})},__WEBPACK_DEFAULT_EXPORT__=SequencePage},1568:(e,t,s)=>{"use strict";s.d(t,{db:()=>c});var n=s(9904),a=s(6553),l=s(7058);let r={apiKey:"AIzaSyDQOKOcCzVBlYvlfAtmdzSLB4ouBXMmGoo",authDomain:"abacas-67eba.firebaseapp.com",projectId:"abacas-67eba",storageBucket:"abacas-67eba.firebasestorage.app",messagingSenderId:"800560735781",appId:"1:800560735781:web:f408083d170babc84d41cc",measurementId:"G-RS3NJCLQNN"},i=(0,n.Wp)(r);(0,a.P5)(i);let c=(0,l.aU)(i)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,375,441,517,358],()=>t(8091)),_N_E=e.O()}]);